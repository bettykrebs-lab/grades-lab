---
title: "krebs"
author: "Betty Krebs"
format: html
---

Please find here the link to my Github repository : https://github.com/bettykrebs-lab/grades-lab.git

```{r}
here::i_am("grades-lab.Rproj")
library(here)
library(ggplot2)
library(tidyr)
library(dplyr)
library(vroom)
```
##Question 1
```{r}
course <- vroom("C:/Users/bkreb/OneDrive/Documents/grades-lab/courses.csv")
```

##Question 2
```{r}
course_data <- data.frame(
  course_name = c(
    "Vedic Philosophy and Spirituality",
    "Yoga and Meditation",
    "Ayurveda and Traditional Medicine",
    "Astrology and Astrology",
    "Music and Dance",
    "Sanskrit Language and Literature",
    "History and Civilization of India",
    "Architecture and Sculpture",
    "Martial Arts and Self-Defense",
    "Politics and Diplomacy"
  ),
  identifier = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10),
  module = c(2, 2, 1, 1, 2, 2, 1, 1, 2, 2),
  number_of_exams = c(5, 5, 6, 4, 10, 10, 8, 9, 5, 10)
)
sorted_data <- course_data[order(course_data[["course_name"]]), ]
final_data <- sorted_data |>
  setNames(c("course name", "identifier", "module", "number of exams"))
knitr::kable(final_data)
```

#Question 3 : loading students

```{r}
students <- read.csv("students.csv", 
                 colClasses = c(id = "integer", group = "factor", birth_date = "character", sex = "factor"))
students <- students |>
  mutate(birth_date = as.Date(birth_date, format = "%Y-%m-%d"))
```

#Question 4 : grades 
```{r}
grades <-vroom("C:/Users/bkreb/OneDrive/Documents/grades-lab/grades.csv", delim = "|",na = "_")
```

#Question 5 : number of students per group 

```{r}
students |>
  summarise(count = n(), .by = group) |> 
  ggplot(aes(x = group, y = count)) + 
    geom_bar(stat = "identity")
```
#Question 6 
```{r}
students |>
  group_by(group, sex) |>
  summarise(count = n(), .groups = 'drop') |>
  ggplot(aes(x = group, y = count, fill = sex)) +
  geom_bar(stat = "identity", position = "stack") +
  
  labs(title = "Students Per Group, Stacked by Sex",
       x = "Group",
       y = "Count",
       fill = "Sex") +
  theme_minimal()
```
#Question 7 : distribution of the age of students

```{r}
library(lubridate)
```

```{r}
students |>
  mutate(
    age = time_length(interval(birth_date, today()), unit = "year"),
    age_integer = as.integer(round(age)) 
  ) |>
  group_by(age_integer) |>
  summarise(count = n(), .groups = 'drop') |>
  ggplot(aes(x = age_integer, y = count)) +
  geom_bar(stat = "identity")
  labs(title = "Distribution of Student Age",
       x = "Age (Years)",
       y = "Number of Students") +
  theme_minimal()
```


